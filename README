Very messy code from darthack night. Needs cleanup, removal of certain debug code and documentation
